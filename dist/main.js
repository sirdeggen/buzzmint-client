window.BuzzmintClient=class{constructor(t,{mintId:i,onSuccess:e,onError:n,host:o="https://app.buzzmint.io"}){if(!i||"string"!=typeof i)throw new Error("mintId is required, and must be a string");if(!e||"function"!=typeof e)throw new Error("onSuccess callback function is required");if(!n||"function"!=typeof n)throw new Error("onError callback function is required");this.div=t,this.host=o,this.mintId=i,this.onSuccess=e,this.onError=n,this.loggedIn=!1,this.kickoff().then((()=>console.log("Buzzmint Client Ready")))}async kickoff(){try{await this.setupIframe(),this.setListeners(),this.getTokens()}catch(t){console.log({error:t})}}async setupIframe(){return new Promise((t=>{this.iframe=window.document.createElement("iframe"),this.iframe.id="buzzmintIframe",this.iframe.src=`${this.host}/valid/v1/${this.mintId}`,this.iframe.style.width="1px",this.iframe.style.height="1px",this.iframe.style.border="none",this.div.appendChild(this.iframe),this.iframe.contentWindow.postMessage("login","*"),this.iframe.onload=()=>{t()}}))}loginWindow(){this?.loggedIn||this?.iframe&&(window.location=`${this.host}/login?redirect=${window.location.href}`)}attachEvent(t,i){if(t?.data&&"buzzmint"===t?.data?.source){console.log({data:t?.data});const e=t?.data||{};if(""===t.data&&i.onError(new Error("No data from Buzzmint")),"yes"===e?.loggedIn&&(i.loggedIn=!0),"no"===e?.loggedIn&&!1===i?.loggedIn)return i.loginWindow();if(e?.tokens)return void this.onSuccess(e)}}setListeners(){window.addEventListener("message",(t=>this.attachEvent(t,this)))}getTokens(){this?.iframe&&this.iframe.contentWindow.postMessage("getTokens","*")}};